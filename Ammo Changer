--// Services
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local LocalPlayer = Players.LocalPlayer

--// Prevent duplicate UI
if game.CoreGui:FindFirstChild("HydroxideAmmoUI") then
    game.CoreGui.HydroxideAmmoUI:Destroy()
end

--// Load Hydroxide aux
local aux = loadstring(game:HttpGetAsync(
    "https://raw.githubusercontent.com/Upbolt/Hydroxide/revision/ohaux.lua"
))()

--// Default values (editable in UI)
local ToolName = "G18c Switch"
local AmmoValue = 99999999999999

--// ScreenGui
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "HydroxideAmmoUI"
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = game.CoreGui

--// Main Frame
local Frame = Instance.new("Frame")
Frame.Size = UDim2.fromOffset(260, 160)
Frame.Position = UDim2.fromScale(0.5, 0.5)
Frame.AnchorPoint = Vector2.new(0.5, 0.5)
Frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
Frame.BorderSizePixel = 0
Frame.Parent = ScreenGui

--// Corner
Instance.new("UICorner", Frame).CornerRadius = UDim.new(0, 12)

--// Title
local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(1, 0, 0, 30)
Title.BackgroundTransparency = 1
Title.Text = "Ammo changer"
Title.TextColor3 = Color3.new(1, 1, 1)
Title.Font = Enum.Font.GothamBold
Title.TextSize = 14
Title.Parent = Frame

--// Tool Name Box
local ToolBox = Instance.new("TextBox")
ToolBox.PlaceholderText = "Tool Name (ex: G18c Switch)"
ToolBox.Text = ToolName
ToolBox.Size = UDim2.new(1, -20, 0, 30)
ToolBox.Position = UDim2.fromOffset(10, 40)
ToolBox.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
ToolBox.TextColor3 = Color3.new(1, 1, 1)
ToolBox.Font = Enum.Font.Gotham
ToolBox.TextSize = 13
ToolBox.ClearTextOnFocus = false
ToolBox.Parent = Frame
Instance.new("UICorner", ToolBox).CornerRadius = UDim.new(0, 8)

--// Ammo Value Box
local ValueBox = Instance.new("TextBox")
ValueBox.PlaceholderText = "Ammo Value"
ValueBox.Text = tostring(AmmoValue)
ValueBox.Size = UDim2.new(1, -20, 0, 30)
ValueBox.Position = UDim2.fromOffset(10, 80)
ValueBox.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
ValueBox.TextColor3 = Color3.new(1, 1, 1)
ValueBox.Font = Enum.Font.Gotham
ValueBox.TextSize = 13
ValueBox.ClearTextOnFocus = false
ValueBox.Parent = Frame
Instance.new("UICorner", ValueBox).CornerRadius = UDim.new(0, 8)

--// Apply Button
local Button = Instance.new("TextButton")
Button.Text = "Apply Ammo"
Button.Size = UDim2.new(1, -20, 0, 35)
Button.Position = UDim2.fromOffset(10, 120)
Button.BackgroundColor3 = Color3.fromRGB(70, 130, 255)
Button.TextColor3 = Color3.new(1, 1, 1)
Button.Font = Enum.Font.GothamBold
Button.TextSize = 14
Button.Parent = Frame
Instance.new("UICorner", Button).CornerRadius = UDim.new(0, 10)

--// Button Logic
Button.MouseButton1Click:Connect(function()
    ToolName = ToolBox.Text
    AmmoValue = tonumber(ValueBox.Text) or AmmoValue

    local toolFolder = workspace:FindFirstChild("Peterdoodoo")
    if not toolFolder then return end

    local tool = toolFolder:FindFirstChild(ToolName)
    if not tool then return end

    local GunClient = tool:FindFirstChild("GunClient")
    if not GunClient then return end

    local closure = aux.searchClosure(
        GunClient,
        "Reload",
        2,
        {
            [1] = "ActuallyEquipped",
            [2] = "Enabled",
            [3] = "Reloading",
            [4] = "Ammo",
            [5] = "LimitedAmmoEnabled",
            [6] = "Mag"
        }
    )

    if closure then
        debug.getupvalue(closure, 2)["Mag"] = AmmoValue
    end
end)

--// Dragging (Mobile + PC)
do
    local dragging, dragStart, startPos

    local function update(input)
        local delta = input.Position - dragStart
        Frame.Position = UDim2.fromOffset(
            startPos.X.Offset + delta.X,
            startPos.Y.Offset + delta.Y
        )
    end

    Frame.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1
        or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = Frame.Position

            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if dragging and
        (input.UserInputType == Enum.UserInputType.MouseMovement
        or input.UserInputType == Enum.UserInputType.Touch) then
            update(input)
        end
    end)
end
